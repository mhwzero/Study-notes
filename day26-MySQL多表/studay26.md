# MySQL多表
[toc]
## 多表的关系
### 一对一
    在从表中手动加入一个外键列指向主表的主键，而且要给这个外键列加上唯一约束
### 一对多
1. 会在从表的一方新建一列，指向主表的主键列，列名字一般是(主键名_主键名)
2. 将新建的这一列称为外键列(外键的作用是为了建立当前表和其他表的关联关系)
3. 在一张表中是允许有多个外键列的
### 多对多
1. 新建一张中间表，作为两张主表的从表存在
2. 在中间表创建两个外键，分别指向两张主表的主键
3. 多对多一个关系本质上是两个一对多拼接而成

## 多表查询
### 连接查询
#### 交叉连接
```sql
--解释
    使用左表中的每一条数据分别去连接2表中的每一条数据,将所有连接结果都展示出来,其实也就相当于是左边乘以右边
--语法
    select * from 左表,右表
```
#### 内连接
```sql
-- 解释
使用左表中每一条数据分别去连接右表中的每一条数据,仅仅显示匹配成功的部分
-- 语法
 隐式内连接: select * from 左表,右表 where 连接条件
 显示内连接: select * from 左表 [inner] join 右表 on 连接条件
```
#### 左连接
```sql
-- 解释
首先要显示出左表的全部,然后使用连接条件匹配右表,能匹配中的就显示,匹配不中的显为null
-- 语法
select * from 左表 left [outer] join 右表 on 连接条件
```
#### 右连接
```sql
-- 解释
首先要显示出右表的全部, 然后使用连接条件匹配左表,能匹配中的就显示,匹配不中的显示为null
-- 语法
select * from 左表 right [outer] join 右表 on 连接条件
```
#### 小结
```sql
-- 内连接
select * from 左表 join 右表 on 连接条件
-- 左外连接
select * from 左表 left [outer] join 右表 on 连接条件
```
### 子查询
```sql
-- 解释:
一个查询使用了另一个查询的结果

-- 案例:
select * from emp where salary = (select max(salary) from emp);
```
### 自查询
```sql
-- 返回每个员工的名称及其上级领导的名称
select e.ename,ld.ename from emp e left outer join emp ld on e.mgr=ld.id
```
## 事务
### 事务的概念
```
一个业务操作包含多个子操作，如果这个业务操作被事务管理了，那么这些子操作要么同时成功，要么同时失败
   在MySQL数据库中，默认情况下，一条DML语句就是一个独立的事务
```
### 事务有三个方法：
```
   a. begin; 开启事务
   b. commit;  提交事务
   c. rollback;  回滚事务
```
### 三个方法的运行情况
    当MySQL客户端一但发送begin的时候，MySQL服务器便会将它后面的语句放入服务器中的临时区，只有当遇到commit和rollback的时候结束存放，当执行完commit语句的时候，没有出现问题，数据将从临时区进入存储文件区并将清理临时区，如果出现问题将会执行rollback语句实现事务回滚